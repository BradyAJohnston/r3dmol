---
title: "Introduction to r3dmol"
author: "Wei Su"
date: "`r Sys.Date()`"
output:
  md_document:
    pandoc_args: ["--wrap=preserve"]
  html_document:
    theme: flatly
---

<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{Introduction to r3dmol}
-->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This is an R package that provides support for [`3Dmol.js`](https://3dmol.csb.pitt.edu/index.html) as a [`htmlwidgets`](https://www.htmlwidgets.org/). 

> This package is still very early in its development stages, everything will be changed very often! Please give me a star on Github if you find it useful and I will speed up the development process!

```{r installation, eval=FALSE}
# install.packages("devtools")
devtools::install_github('swsoyee/r3dmol')
```

```{r demo}
library(r3dmol)

r3dmol(                                             # Set viewer
  cartoonQuality = 10,
  lowerZoomLimit = 50,
  upperZoomLimit = 350,
  id = "demo",
  elementId = "demo"
) %>%                                               
  m_add_model(data = pdb_6zsl, format = "pdb") %>%  # Add model
  m_zoom_to() %>%                                   # Zoom to center
  m_set_style(                                      # Draw cartoon representation of secondary structure
    style = list(cartoon = list(color = '#00cc96'))) %>%
  m_set_style(sel = list(ss = 's'),                 # Style beta sheet
              style = list(cartoon = list(color = '#636efa', arrows = TRUE))) %>%
  m_set_style(sel = list(ss = 'h'),                 # Style alpha helix
              style = list(cartoon = list(color = '#ff7f0e'))) %>%
  m_rotate(angle = 90, axis = 'y') %>%              # Set the initial angle of rotation 
  m_spin()                                          # Spin it!
```

```{r xyz}
xyz <- "4
* (null), Energy   -1000.0000000
N     0.000005    0.019779   -0.000003   -0.157114    0.000052   -0.012746
H     0.931955   -0.364989    0.000003    1.507100   -0.601158   -0.004108
H    -0.465975   -0.364992    0.807088    0.283368    0.257996   -0.583024
H    -0.465979   -0.364991   -0.807088    0.392764    0.342436    0.764260
"

r3dmol(width = 400,
       height = 400,
       backgroundColor = "0xeeeeee") %>%
  m_add_model(data = xyz,
              format = "xyz",
              options = list(vibrate = list(frames = 10, amplitude = 1))) %>%
  m_set_style(style = list(stick = list())) %>%
  m_animate(list(loop = "backAndForth")) %>%
  m_zoom_to()
```

## About `3Dmol.js`

> Nicholas Rego and David Koes
3Dmol.js: molecular visualization with WebGL
Bioinformatics (2015) 31 (8): 1322-1324 [doi:10.1093/bioinformatics/btu829](http://doi.org/10.1093/bioinformatics/btu829)

